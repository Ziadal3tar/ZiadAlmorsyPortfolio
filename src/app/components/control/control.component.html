<div class="control-page">

  <!-- ðŸ§¾ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø°Ù -->
  <div class="confirm-overlay" *ngIf="confirmRemove">
    <div class="confirm-box">
      <h5 class="fw-bold mb-3">Confirm Deletion</h5>
      <p class="message">Are you sure you want to delete this project?</p>
      <div class="buttons mt-3">
        <button class="btn cancel" (click)="confirmRemove = false">Cancel</button>
        <button class="btn delete" (click)="deleteProject()">Delete</button>
      </div>
    </div>
  </div>

  <!-- ðŸ§© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ -->
  <div class="container py-5">
    <h4 class="fw-semibold mb-4 text-dark">Manage Projects</h4>

    <div class="project-select d-flex align-items-center gap-3">
      <ng-multiselect-dropdown
        class="flex-grow-1"
        [placeholder]="'Select Project to Update'"
        [settings]="updateDropdownSettings"
        [data]="updateDropdownList"
        [(ngModel)]="updateSelectedItems"
        (onSelect)="onItemSelect($event)"
        (onDeSelect)="onDeSelect($event)">
      </ng-multiselect-dropdown>

      <button *ngIf="btnRemove" class="btn btn-outline-danger rounded-3" (click)="confirmRemove = true">
        <i class="bi bi-trash3 me-2"></i> Delete
      </button>
    </div>
  </div>

  <!-- ðŸ§  ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ -->
  <section class="container mb-5">
    <div class="form-section p-4 shadow rounded-4 bg-white">

      <!-- Dropdowns -->
      <div class="row g-4">
        <div class="col-md-6">
          <label class="form-label fw-medium text-secondary mb-1">Technologies</label>
          <ng-multiselect-dropdown
            [placeholder]="'Select Technologies'"
            [settings]="technologiesDropdownSettings"
            [data]="technologiesDropdownList"
            [(ngModel)]="technologiesSelectedItems">
          </ng-multiselect-dropdown>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-medium text-secondary mb-1">Project Type</label>
          <ng-multiselect-dropdown
            [placeholder]="'Select Type'"
            [settings]="typeDropdownSettings"
            [data]="typeDropdownList"
            [(ngModel)]="typeSelectedItems">
          </ng-multiselect-dropdown>
        </div>
      </div>

      <!-- Images -->
      <div class="upload-section mt-4">
        <label for="iamges" class="upload-label">
          <i class="fa-solid fa-images me-2"></i> Upload Images
        </label>
        <input type="file" class="d-none" id="iamges" (change)="upload($event)" multiple>
      </div>

      <!-- Existing images -->
      <div *ngIf="itemSelected" class="image-list mt-4">
        <h6 class="fw-semibold text-secondary mb-3">Existing Images</h6>
        <div *ngFor="let item of itemSelected.images; let i = index" class="image-item shadow-sm">
          <div class="img-info">
            <div class="miniImg" [style.background-image]="'url(' + item + ')'"></div>
            <span>Image {{ i + 1 }}</span>
          </div>
          <div class="actions">
            <i class="bi bi-arrow-repeat text-primary me-3" (click)="replaceImg(i)"></i>
            <i class="bi bi-trash3-fill text-danger" (click)="deleteImg(i)"></i>
          </div>
        </div>
      </div>

      <!-- Form -->
      <form class="mt-5" [formGroup]="projectForm" (ngSubmit)="add(projectForm.value)">
        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label">Project Name</label>
            <input type="text" class="form-control shadow-sm" formControlName="name" [(ngModel)]="name">
          </div>
          <div class="col-md-4">
            <label class="form-label">Description</label>
            <input type="text" class="form-control shadow-sm" formControlName="description" [(ngModel)]="description">
          </div>
          <div class="col-md-4">
            <label class="form-label">Project Link</label>
            <input type="text" class="form-control shadow-sm" formControlName="link" [(ngModel)]="link">
          </div>
        </div>

        <div class="text-end mt-4">
          <button type="submit" class="btn main-btn px-5 py-2 shadow-sm">{{ btnText }}</button>
        </div>
      </form>
    </div>
  </section>

  <app-loading *ngIf="loading"></app-loading>
</div>
